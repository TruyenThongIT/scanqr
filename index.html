<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8">
 <meta name="google-signin-client_id"
 content="765091097213-lpim0bumlhrd2cit0vqija382bdca070.apps.googleusercontent.com">
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <meta http-equiv="X-UA-Compatible" content="ie=edge">
 <script src='//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js'></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js'></script>
 <script src='https://rawgit.com/schmich/instascan-builds/master/instascan.min.js'></script>
 <title>QR Code2</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>



</head>
<body onload="OpenCam()">



 <table border="1" width="300" height="00" style="margin: 50px auto 50px;">
 <tr height="50">
 <td>
 <p style="font-weight: bold; font-size: 20px;" align="center">Máy Quét</p>
 </td>
 <td>
 <p style="font-weight: bold; font-size: 20px;" align="center">Mã QR</p>
 </td>
 </tr>
 <tr>
 <td style="vertical-align:top;"><video id="preview" style="height:320px;"></video></td>
 <td align="center" style="vertical-align: top;">

 <div id="container"></div>
 <br>
 
 <button onclick="btnTat()">TatCam</button>
  <button onclick="OpenCam()">MoCam</button>
<button onclick="cameras1()">Cam Sau</button>
<button onclick="cameras2()">Cam Trước</button>
 </td>
 </tr>
 </table>
</body>
<script type="text/javascript">
 
 let scanner = new Instascan.Scanner(
 {
    video: document.getElementById('preview')  
 });

 scanner.addListener('scan', function (content) {
  
   console.log(content);
   // alert(content);
   // var data = $('form#test-form').serialize();
   url1 ="https://script.google.com/macros/s/AKfycbwPakz0eXQws87qz9c3TdUFvbcIsgSMF5jSUjei7fMT9RviOQIhwMYuNrxvAFROtvvD/exec";
   url2 ="https://script.google.com/macros/s/AKfycbyoRBPEP26dANi7FRCRgOA_auFGUPAbsMYiQlrtgEBlrMGCcFYV/exec"; //mitapp
   $.ajax({
     type: 'Post',
     url:'https://script.google.com/macros/s/AKfycbyoRBPEP26dANi7FRCRgOA_auFGUPAbsMYiQlrtgEBlrMGCcFYV/exec',
     dataType: 'json',
     crossDomain: true,
     sdata: content,

     success: function (sdata) {
     if (sdata == 'false' ) {
       alert('thêm thất bại')  ;
     } else {
       alert('Đã thêm dữ liệu vào Form')  ;
     }
   }
   });
  
  // if(content){
  //   scanner.stop();
  // }
 });
 function btnTat(){
  scanner.stop();
 }
const Cam = 1;
//   function cameras1() {
//   Cam = 1;
//   alert(Cam);
//   }
//   function cameras2() {
//    Cam = 2;
//     alert(Cam);
//   }
 
  function OpenCam() {
    Instascan.Camera.getCameras().then(cameras => {
 
   
   if (cameras.length > 0) {
      scanner.start(cameras[Cam]);
//     console.log(Cam);
   } else {
       console.error("Không tìm thấy Camera !" ) ;
   }
 });
}




</script>
</html>
